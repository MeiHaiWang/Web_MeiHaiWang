$(function(){function a(a){k.setState(a),l.setState(a),m.setState(a),n.setState(a),o.setState(a),p.setState(a),q.setState(a),r.setState(a)}var b=React.createClass({displayName:"CouponKind",getDefaultProps:function(){return{kind:[""]}},getInitialState:function(){return{t_coupon_couponKindId:""}},onChangeSelectValue:function(a){this.setState({t_coupon_couponKindId:a.target.value})},render:function(){var a=this.props.kind.map(function(a){return React.createElement("option",{value:a.t_couponKind_id},a.t_couponKind_Name)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_coupon_couponKindId,onChange:this.onChangeSelectValue},a))}}),c=React.createClass({displayName:"CouponName",getInitialState:function(){return{t_coupon_name:""}},changeText:function(a){this.setState({t_coupon_name:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_coupon_name,onChange:this.changeText}))}}),d=React.createClass({displayName:"CouponDetailText",getInitialState:function(){return{t_coupon_detailText:""}},onChangeText:function(a){this.setState({t_coupon_detailText:a.target.value})},onClick:function(){this.setState({t_coupon_detailText:this.refs.textArea.getDOMNode().value})},render:function(){return React.createElement("div",null,React.createElement("div",null,React.createElement("textarea",{value:this.state.t_coupon_detailText,onChange:this.onChangeText})))}}),e=React.createClass({displayName:"CouponPrice",getInitialState:function(){return{t_coupon_price:""}},changeText:function(a){this.setState({t_coupon_price:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_coupon_price,onChange:this.changeText}))}}),f=React.createClass({displayName:"CouponDeadLine",getInitialState:function(){return{t_coupon_deadLine:""}},changeText:function(a){this.setState({t_coupon_deadLine:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_coupon_deadLine,onChange:this.changeText}))}}),g=React.createClass({displayName:"CouponPresentationCondition",getInitialState:function(){return{t_coupon_presentationCondition:""}},changeText:function(a){this.setState({t_coupon_presentationCondition:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_coupon_presentationCondition,onChange:this.changeText}))}}),h=React.createClass({displayName:"CouponUseCondition",getInitialState:function(){return{t_coupon_useCondition:""}},changeText:function(a){this.setState({t_coupon_useCondition:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_coupon_useCondition,onChange:this.changeText}))}}),i=React.createClass({displayName:"CouponImagePath",getInitialState:function(){return{t_coupon_imagePath:"img/notfound.jpg"}},render:function(){return React.createElement("div",null,React.createElement("img",{className:"coupon_image_img",src:this.state.t_coupon_imagePath?this.state.t_coupon_imagePath:"img/notfound.jpg"}))}}),j=React.createClass({displayName:"CouponList",getInitialState:function(){return{coupon_list:[{t_coupon_Id:"",t_coupon_name:"",t_coupon_detailText:"",t_coupon_price:"",t_coupon_imagePath:"img/notfound.jpg"}]}},render:function(){var a=1,b=this.state.coupon_list.map(function(b){return React.createElement("tr",null,React.createElement("td",null,a++),React.createElement("td",null,b.t_coupon_name),React.createElement("td",null,b.t_coupon_price),React.createElement("td",null,b.t_coupon_detailText),React.createElement("td",null,React.createElement("img",{src:b.t_coupon_imagePath?b.t_coupon_imagePath:"img/notfound.jpg"})),React.createElement("td",null,React.createElement("a",{className:"edit"},"编辑"),"/",React.createElement("a",{className:"delete"},"删除")))});return React.createElement("div",null,React.createElement("table",null,React.createElement("tr",null,React.createElement("th",null,"No."),React.createElement("th",null,"优惠券名称"),React.createElement("th",null,"价格"),React.createElement("th",null,"优惠券内容"),React.createElement("th",null,"照片"),React.createElement("th",null,"编辑")),b))}}),k=React.render(React.createElement(b,null),document.getElementById("coupon_kind")),l=React.render(React.createElement(c,null),document.getElementById("coupon_name")),m=React.render(React.createElement(d,null),document.getElementById("coupon_detail_text")),n=React.render(React.createElement(e,null),document.getElementById("coupon_price")),o=React.render(React.createElement(f,null),document.getElementById("coupon_dead_line")),p=React.render(React.createElement(g,null),document.getElementById("coupon_presentation_condition")),q=React.render(React.createElement(h,null),document.getElementById("coupon_use_condition")),r=React.render(React.createElement(i,null),document.getElementById("coupon_image_path")),s=React.render(React.createElement(j,null),document.getElementById("coupon_list_info")),t=getSessionInfo(),u=getCouponInfo(t.t_hairSalonMaster_salonId),v=getCouponKindList();sanitaize.decode(u),sanitaize.decode(v),$("#account-name").text(t.t_hairSalonMaster_contactUserName),k.setProps({kind:v.kind}),k.setState({t_coupon_couponKindId:k.props.kind[0].t_couponKind_id}),0!=u.coupon.length&&s.setState({coupon_list:u.coupon}),$("#coupon_regist_button").on("click",function(){var a={t_hairSalonMaster_salonId:t.t_hairSalonMaster_salonId,t_coupon_Id:k.state.t_coupon_Id,t_coupon_couponKindId:k.state.t_coupon_couponKindId,t_coupon_name:l.state.t_coupon_name,t_coupon_detailText:m.state.t_coupon_detailText,t_coupon_price:n.state.t_coupon_price,t_coupon_deadLine:o.state.t_coupon_deadLine,t_coupon_presentationCondition:p.state.t_coupon_presentationCondition,t_coupon_useCondition:q.state.t_coupon_useCondition,t_coupon_imagePath:r.state.t_coupon_imagePath};sanitaize.encode(a);var b=setCouponInfo(a);"true"==b.result?(alert("Regist Success"),window.location.reload()):alert("Regist Failed")}),$(".edit").on("click",function(){if(0==u.coupon.length)return!1;var b=$(".edit").index(this);a(u.coupon[b])}),$(".delete").on("click",function(){if(0==u.coupon.length)return!1;var a=!1;if(function(){window.confirm("本当に削除しますか？")?(console.log("OK clicked."),a=!0):(alert("キャンセルされました"),a=!1)}(),!a)return!1;var b=$(".delete").index(this),c={t_coupon_Id:u.coupon[b].t_coupon_Id};sanitaize.encode(c);var d=deleteCouponInfo(c);"true"==d.result?(alert("Delete Success"),window.location.reload()):alert("Delete Failed")}),$("#coupon_image").change(function(){if($(this).prop("files")[0]){var a=new FormData($("#update")[0]);console.log("async upload image."),function(a){$.ajax({type:"POST",url:API_PATH+"uploadImage",async:!0,processData:!1,data:a,dataType:"text",contentType:!1}).then(function(a){a=JSON.parse(a),"true"==a.result?r.setState({t_coupon_imagePath:a.image_path}):alert("Upload Failed")})}(a)}})});