$(function(){function a(a){var b=getYearMonthDayByDateTime(a.t_stylist_birth);q.setState(a),r.setState(a),s.setState(b),t.setState(b),u.setState(b),v.setState(a),w.setState(a),x.setState(a),y.setState(a),z.setState(a),A.setState(a),B.setState(a)}var b=React.createClass({displayName:"StylistName",getInitialState:function(){return{t_stylist_name:""}},changeText:function(a){this.setState({t_stylist_name:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_stylist_name,onChange:this.changeText}))}}),c=React.createClass({displayName:"StylistSex",getDefaultProps:function(){return{sex:[{value:0,text:"男士"},{value:1,text:"女士"}]}},getInitialState:function(){return{t_stylist_sex:0}},onChangeSelectValue:function(a){this.setState({t_stylist_sex:a.target.value})},render:function(){var a=this.props.sex.map(function(a){return React.createElement("option",{value:a.value},a.text)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_stylist_sex,onChange:this.onChangeSelectValue},a))}}),d=React.createClass({displayName:"StylistBirthYear",getDefaultProps:function(){for(var a=new Date,b=a.getFullYear(),c=new Array,d=b;d>=1950;d--)c.push(d.toString(10));return{birth_year:c}},getInitialState:function(){return{year:this.props.birth_year[0]}},onChangeSelectValue:function(a){this.setState({year:a.target.value});for(var b,c=new Date(a.target.value,t.state.month,0).getDate(),d=new Array,e=1;c>=e;e++)b=e,10>b&&(b="0"+b),d.push(b.toString(10));u.setProps({birth_day:d})},render:function(){var a=this.props.birth_year.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.year,onChange:this.onChangeSelectValue},a))}}),e=React.createClass({displayName:"StylistBirthMonth",getDefaultProps:function(){for(var a,b=new Array,c=1;12>=c;c++)a=c,10>a&&(a="0"+a),b.push(a.toString(10));return{birth_month:b}},getInitialState:function(){return{month:this.props.birth_month[0]}},onChangeSelectValue:function(a){this.setState({month:a.target.value});for(var b,c=new Date(s.state.year,a.target.value,0).getDate(),d=new Array,e=1;c>=e;e++)b=e,10>b&&(b="0"+b),d.push(b.toString(10));u.setProps({birth_day:d})},render:function(){var a=this.props.birth_month.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.month,onChange:this.onChangeSelectValue},a))}}),f=React.createClass({displayName:"StylistBirthDay",getDefaultProps:function(){for(var a,b=new Array,c=1;31>=c;c++)a=c,10>a&&(a="0"+a),b.push(a.toString(10));return{birth_day:b}},getInitialState:function(){return{day:this.props.birth_day[0]}},onChangeSelectValue:function(a){this.setState({day:a.target.value})},render:function(){var a=this.props.birth_day.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.day,onChange:this.onChangeSelectValue},a))}}),g=React.createClass({displayName:"StylistPhoneNumber",getInitialState:function(){return{t_stylist_phoneNumber:""}},changeText:function(a){this.setState({t_stylist_phoneNumber:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_stylist_phoneNumber,onChange:this.changeText}))}}),h=React.createClass({displayName:"StylistPosition",getInitialState:function(){return{t_stylist_position:""}},changeText:function(a){this.setState({t_stylist_position:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_stylist_position,onChange:this.changeText}))}}),i=React.createClass({displayName:"StylistMail",getInitialState:function(){return{t_stylist_mail:""}},changeText:function(a){this.setState({t_stylist_mail:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_stylist_mail,onChange:this.changeText}))}}),j=React.createClass({displayName:"StylistExperienceYear",getDefaultProps:function(){for(var a=new Array,b=0;30>=b;b++)a.push(b.toString(10));return{experience_year:a}},getInitialState:function(){return{t_stylist_experienceYear:0}},onChangeSelectValue:function(a){this.setState({t_stylist_experienceYear:a.target.value})},render:function(){var a=this.props.experience_year.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_stylist_experienceYear,onChange:this.onChangeSelectValue},a))}}),k=React.createClass({displayName:"StylistSpecialMenu",getInitialState:function(){return{t_stylist_specialMenu:""}},changeText:function(a){this.setState({t_stylist_specialMenu:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_stylist_specialMenu,onChange:this.changeText}))}}),l=React.createClass({displayName:"StylistMessage",getInitialState:function(){return{t_stylist_message:""}},onChangeText:function(a){this.setState({t_stylist_message:a.target.value})},onClick:function(){this.setState({t_stylist_message:this.refs.textArea.getDOMNode().value})},render:function(){return React.createElement("div",null,React.createElement("div",null,React.createElement("textarea",{value:this.state.t_stylist_message,onChange:this.onChangeText})))}}),m=React.createClass({displayName:"StylistImagePath",getInitialState:function(){return{t_stylist_imagePath:"img/notfound.jpg"}},render:function(){return React.createElement("div",null,React.createElement("img",{className:"service_image_img",src:this.state.t_stylist_imagePath?this.state.t_stylist_imagePath:"img/notfound.jpg"}))}}),n=React.createClass({displayName:"StylistList",getInitialState:function(){return{stylist_list:[{t_stylist_Id:"",t_stylist_name:"",t_stylist_position:"",t_stylist_phoneNumber:"",t_menu_t_menu_id:[""]}]}},render:function(){var a=1,b=this.state.stylist_list.map(function(b){return React.createElement("tr",null,React.createElement("td",null,a++),React.createElement("td",null,b.t_stylist_name),React.createElement("td",null,b.t_stylist_position),React.createElement("td",null,b.t_stylist_phoneNumber),React.createElement("td",null,b.t_menu_t_menu_name),React.createElement("td",null,React.createElement("a",{className:"edit"},"编辑"),"/",React.createElement("a",{className:"delete"},"删除")))});return React.createElement("div",null,React.createElement("table",null,React.createElement("tr",null,React.createElement("th",null,"No."),React.createElement("th",null,"姓名"),React.createElement("th",null,"职位"),React.createElement("th",null,"电话号码"),React.createElement("th",null,"可能服务"),React.createElement("th",null,"编辑")),b))}}),o=React.createClass({displayName:"StylistServiceMapingName",getDefaultProps:function(){return{stylists:[""]}},getInitialState:function(){return{t_stylist_Id:""}},onChangeSelectValue:function(a){this.setState({t_stylist_Id:a.target.value})},render:function(){var a=this.props.stylists.map(function(a){return React.createElement("option",{value:a.t_stylist_Id},a.t_stylist_name)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_stylist_Id,onChange:this.onChangeSelectValue},a))}}),p=React.createClass({displayName:"StylistServiceMapingService",getDefaultProps:function(){return{services:[""]}},getInitialState:function(){return{t_menu_menu_id:""}},onChangeSelectValue:function(a){this.setState({t_menu_menu_id:a.target.value})},render:function(){var a=this.props.services.map(function(a){return React.createElement("option",{value:a.t_menu_menu_id},a.t_menu_name)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_menu_menu_id,onChange:this.onChangeSelectValue},a))}}),q=React.render(React.createElement(b,null),document.getElementById("stylist_name")),r=React.render(React.createElement(c,null),document.getElementById("stylist_sex")),s=React.render(React.createElement(d,null),document.getElementById("stylist_birth_year")),t=React.render(React.createElement(e,null),document.getElementById("stylist_birth_month")),u=React.render(React.createElement(f,null),document.getElementById("stylist_birth_day")),v=React.render(React.createElement(g,null),document.getElementById("stylist_phone_number")),w=React.render(React.createElement(h,null),document.getElementById("stylist_position")),x=React.render(React.createElement(i,null),document.getElementById("stylist_mail")),y=React.render(React.createElement(j,null),document.getElementById("stylist_experience_year")),z=React.render(React.createElement(k,null),document.getElementById("stylist_special_menu")),A=React.render(React.createElement(l,null),document.getElementById("stylist_message")),B=React.render(React.createElement(m,null),document.getElementById("stylist_image_path")),C=React.render(React.createElement(n,null),document.getElementById("stylist_list_info")),D=React.render(React.createElement(o,null),document.getElementById("stylist_service_maping_name")),E=React.render(React.createElement(p,null),document.getElementById("stylist_service_maping_service")),F=getSessionInfo(),G=getStaffInfo(F.t_hairSalonMaster_salonId);sanitaize.decode(G),$("#account-name").text(F.t_hairSalonMaster_contactUserName);var H=getServiceList(F.t_hairSalonMaster_salonId);sanitaize.decode(H);for(var I=new Array,J=0;J<H.menu.length;J++){var K=H.menu[J].t_menu_menu_id,L=H.menu[J].t_menu_name;I[K]=L}for(var J=0;J<G.stylist.length;J++){for(var M=G.stylist[J].t_menu_t_menu_id.split(","),N=new Array,O=0;O<M.length;O++)N.push(I[M[O]]);G.stylist[J].t_menu_t_menu_name=N.join(",")}D.setProps({stylists:G.stylist}),E.setProps({services:H.menu}),0!=G.stylist.length&&(C.setState({stylist_list:G.stylist}),D.setState(G.stylist[0]),E.setState(H.menu[0])),$("#stylist_regist_button").on("click",function(){var a=s.state.year+"-"+t.state.month+"-"+u.state.day+" 00:00:00",b=!0;if((""==q.state.t_stylist_name||null==q.state.t_stylist_name)&&(alert("Regist Failed... name is empty."),b=!1),(""==v.state.t_stylist_phoneNumber||null==v.state.t_stylist_phoneNumber)&&(alert("Regist Failed... phone_number is empty."),b=!1),(""==x.state.t_stylist_mail||null==x.state.t_stylist_mail)&&(alert("Regist Failed... mail_address is empty."),b=!1),1==b){var c={t_hairSalonMaster_salonId:F.t_hairSalonMaster_salonId,t_stylist_Id:q.state.t_stylist_Id,t_stylist_name:q.state.t_stylist_name,t_stylist_sex:r.state.t_stylist_sex,t_stylist_phoneNumber:v.state.t_stylist_phoneNumber,t_stylist_mail:x.state.t_stylist_mail,t_stylist_imagePath:B.state.t_stylist_imagePath,t_stylist_birth:a,t_stylist_position:w.state.t_stylist_position,t_stylist_experienceYear:y.state.t_stylist_experienceYear,t_stylist_specialMenu:z.state.t_stylist_specialMenu,t_stylist_message:A.state.t_stylist_message};sanitaize.encode(c),console.log(" t_stylist_Id: "+q.state.t_stylist_Id+" t_stylist_name: "+q.state.t_stylist_name);var d=setStaffInfo(c);"true"==d.result?(alert("Regist Success"),window.location.reload()):alert("Regist Failed"+d.reason)}}),$(".edit").on("click",function(){if(0==G.stylist.length)return!1;var b=$(".edit").index(this);a(G.stylist[b])}),$(".delete").on("click",function(){if(0==G.stylist.length)return!1;var a=!1;if(function(){window.confirm("本当に削除しますか？")?(console.log("OK clicked."),a=!0):(alert("キャンセルされました"),a=!1)}(),!a)return!1;var b=$(".delete").index(this);console.log(G.stylist[b].t_stylist_Id+","+b);var c={t_stylist_Id:G.stylist[b].t_stylist_Id};sanitaize.encode(c);var d=deleteStaffInfo(c);"true"==d.result?(alert("Delete Success"),window.location.reload()):alert("Delete Failed")}),$("#stylist_service_maping_regist_button").on("click",function(){var a=$("#stylist_service_maping_name select").prop("selectedIndex"),b=D.state.t_stylist_Id;if("undefined"!=typeof G.stylist[a])for(var c=G.stylist[a].t_menu_t_menu_id.split(","),d=E.state.t_menu_menu_id,e=new Array,f=0;f<c.length;f++)e.push(c[f]);if(null==b||null==e)alert("Regist Failed");else if(-1!==e.indexOf(d))alert("Already exists");else{e.push(d),e=e.join(",");var g={t_stylist_Id:b,t_menu_t_menu_id:e};sanitaize.encode(g);var h=setStaffMenu(g);"true"==h.result?(alert("Regist Success"),window.location.reload()):alert("Regist Failed")}}),$("#stylist_service_maping_delete_button").on("click",function(){var a=D.state.t_stylist_Id,b={t_stylist_Id:a};sanitaize.encode(b);var c=deleteStaffMenu(b);"true"==c.result?(alert("Delete Success"),window.location.reload()):alert("Delete Failed")}),$("#stylist_image").change(function(){if($(this).prop("files")[0]){var a=new FormData($("#update")[0]);console.log("async upload image."),function(a){$.ajax({type:"POST",url:API_PATH+"uploadImage",async:!0,processData:!1,data:a,dataType:"text",contentType:!1}).then(function(a){a=JSON.parse(a),"true"==a.result?B.setState({t_stylist_imagePath:a.image_path}):alert("Upload Failed")})}(a)}})});