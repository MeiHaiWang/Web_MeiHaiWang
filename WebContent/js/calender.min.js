$(function(){function a(a){for(var b=e.stylist,c=[],d=[],g=0;g<b.length;g++){c[g]=[],d[g]=0;for(var h=0;h<f.length;h++)if(b[g].t_stylist_name==f[h].t_stylist_name){d[g]++;var i=moment(f[h].t_reservation_date),j=moment(f[h].t_reservation_date).add("hours",2);c[g].push({from:"/Date("+i.valueOf()+")/",to:"/Date("+j.valueOf()+")/",label:f[h].t_menu_name,customClass:"ganttRed",dataObj:f[h].t_reservation_id})}if(0==d[g],null!=b[g].t_stylist_restTime&&""!=b[g].t_stylist_restTime){var k=b[g].t_stylist_restTime.substring(0,5),l=b[g].t_stylist_restTime.substring(6,11),m=a.substring(0,10)+k+":00",n=a.substring(0,10)+l+":00";c[g].push({from:moment(m).valueOf(),to:moment(n).valueOf(),label:"休憩",customClass:"",dataObj:""})}}for(var o=[],g=0;g<b.length;g++)o.push({name:"staff"+g,id:g,desc:b[g].t_stylist_name,values:c[g]});var p=function(a){for(var c=-1,d=0;d<b.length;d++)a==b[d].t_stylist_name&&(c=b[d].t_stylist_Id);return c};$(".gantt").gantt({source:o,scale:"hours",navigate:"scroll",maxScale:"days",itemsPerPage:10,months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dow:["日","月","火","水","木","金","土"],onItemClick:function(a){console.log("reservation.html?reservationId="+a),location.href="reservation.html?reservationId="+a},onAddClick:function(a,b){if(void 0!=b){var c=moment(Number(a)),d=c.year()+"/",e=Number(c.month())+1;d+=10>e?"0"+e+"/":e+"/",d+=c.date()<10?"0"+c.date()+" ":c.date()+" ",d+=c.hours()<10?"0"+c.hours()+":":c.hours()+":",d+=c.minutes()<10?"0"+c.minutes()+":":c.minutes()+":",d+=c.seconds()<10?"0"+c.seconds():c.seconds();var f=p(o[b].desc);alert("reservation.html?time="+d+"&stylistId="+f),location.href="reservation.html?time="+d+"&stylistId="+f}},onRender:function(){window.console&&"function"==typeof console.log&&console.log("chart rendered")}})}var b=new Date,c=b.getFullYear()+"-";b.getMonth()+1<10&&(c+="0"),c+=b.getMonth()+1+"-",b.getDate()+1<10&&(c+="0"),c+=b.getDate()+" 09:00:00";var d=getSessionInfo(),e=getStaffInfo({t_hairSalonMaster_salonId:d.t_hairSalonMaster_salonId}),f={};reservations=getReservationList({t_reservation_salonId:d.t_hairSalonMaster_salonId,t_reservation_date:c}),f=reservations.reservation_list,console.log("reservationNumber : "+f.length),$("#account-name").text(d.t_hairSalonMaster_contactUserName);var g={},h={},j=0,k=0;for(i=0;i<f.length;i++)0==f[i].t_reservation_isFinished?(g[j]=f[i],j++):f[i].t_reservation_isFinished>0&&(h[k]=f[i],k++);$("#reserve_number").text(j),$("#customer_number").text(k),$("#datepicker").datepicker({onSelect:function(b,c){console.log("put a "+b);var e=moment(b),g=e.year()+"-";e.month()+1<10&&(g+="0"),g+=e.month()+1+"-",e.date()+1<10&&(g+="0"),g+=e.date()+" 09:00:00",console.log(g),reservations=getReservationList({t_reservation_salonId:d.t_hairSalonMaster_salonId,t_reservation_date:g}),f=reservations.reservation_list,a(g)}}),a(c),$("#reservation_list_button").on("click",function(){console.log("reservationlist.html?date="+c),location.href="reservationlist.html?date="+c}),$("#customer_list_button").on("click",function(){console.log("customer.html"),location.href="customer.html"})});