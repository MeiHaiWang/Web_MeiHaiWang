$(function(){function a(a){console.log("Edit_sid of album{id "+a.t_hairStyle_id+"}:"+a.t_hairStyle_searchConditionId),J.setState(a),K.setState({t_hairStyle_stylistId:a.t_hairStyle_stylistId}),$("#album_sex_list").tagit("removeAll"),$("#album_long_list").tagit("removeAll"),$("#album_feel_list").tagit("removeAll"),pa=a.t_hairStyle_searchConditionId;var b=ba(pa,0);for(u=0;u<b.length;u++)$("#album_sex_list").tagit("createTag",b[u]);var c=ba(pa,1);for(u=0;u<c.length;u++)$("#album_long_list").tagit("createTag",c[u]);var d=ba(pa,2);for(u=0;u<d.length;u++)$("#album_feel_list").tagit("createTag",d[u])}var b=React.createClass({displayName:"AlbumSex",getDefaultProps:function(){return{gender_tag:[""]}},getInitialState:function(){return{t_hairStyle_searchConditionId:""}},onChangeSelectValue:function(a){H[0][0].name==a.target.value?(console.log("mens_search_condition.titles:"+D.titles[0].name),E=C.titles,F=C.values,I(E,F)):(console.log("womens_search_condition.titles:"+D.titles[0].name),E=D.titles,F=D.values,I(E,F));var b=_(1);M.setProps({length_tag:b});var c=_(2);N.setProps({feel_tag:c});var d=da(a.target.value);$("#album_sex_list").tagit("removeAll"),$("#album_long_list").tagit("removeAll"),$("#album_feel_list").tagit("removeAll");var e=ba(d,0);for(u=0;u<e.length;u++)$("#album_sex_list").tagit("createTag",e[u]);var f=ba(pa,1);for(u=0;u<f.length;u++)$("#album_long_list").tagit("createTag",f[u]);var g=ba(pa,2);for(u=0;u<g.length;u++)$("#album_feel_list").tagit("createTag",g[u]);this.setState({t_hairStyle_searchConditionId:d})},render:function(){var a=this.props.gender_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_hairStyle_searchConditionId,onChange:this.onChangeSelectValue},a))}}),c=React.createClass({displayName:"AlbumName",getInitialState:function(){return{t_hairStyle_name:""}},changeText:function(a){this.setState({t_hairStyle_name:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_hairStyle_name,onChange:this.changeText}))}}),d=React.createClass({displayName:"AlbumLong",getDefaultProps:function(){return{length_tag:[""]}},getInitialState:function(){return{t_hairStyle_searchConditionId:""}},onChangeSelectValue:function(a){var b=da(a.target.value),c=document.getElementsByName("tags"),d="";for(p=0;p<c.length;p++)-1!=da(c[p].value)&&(0==d.length?d=da(c[p].value):d+=","+da(c[p].value));pa=d,pa+="",ca(pa,b)||(pa.length<=0?pa=b:pa+=","+b),$("#album_long_list").tagit("removeAll");var e=ba(pa,1);for(u=0;u<e.length;u++)$("#album_long_list").tagit("createTag",e[u]);this.setState({t_hairStyle_searchConditionId:pa})},render:function(){var a=this.props.length_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_hairStyle_searchConditionId,onChange:this.onChangeSelectValue},a))}}),e=React.createClass({displayName:"AlbumFeel",getDefaultProps:function(){return{feel_tag:[""]}},getInitialState:function(){return{t_hairStyle_searchConditionId:""}},onChangeSelectValue:function(a){var b=da(a.target.value),c=document.getElementsByName("tags2"),d="";for(p=0;p<c.length;p++)-1!=da(c[p].value)&&(0==d.length?d=da(c[p].value):d+=","+da(c[p].value));pa=d,pa+="",ca(pa,b)||(pa.length<=0?pa=b:pa+=","+b),$("#album_feel_list").tagit("removeAll");var e=ba(pa,2);for(u=0;u<e.length;u++)$("#album_feel_list").tagit("createTag",e[u]);this.setState({t_hairStyle_searchConditionId:pa})},render:function(){var a=this.props.feel_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_hairStyle_searchConditionId,onChange:this.onChangeSelectValue},a))}}),f=React.createClass({displayName:"AlbumSearchSex",getDefaultProps:function(){return{search_gender_tag:[""]}},getInitialState:function(){return{album_search_sex_id:""}},onChangeSelectValue:function(a){H[0][0].name==a.target.value?(console.log("mens_search_condition.titles:"+D.titles[0].name),E=C.titles,F=C.values,I(E,F)):(console.log("womens_search_condition.titles:"+D.titles[0].name),E=D.titles,F=D.values,I(E,F));var b=_(1);T.setProps({search_length_tag:b});var c=_(2);U.setProps({search_feel_tag:c});var d=da(a.target.value);this.setState({album_search_sex_id:d})},render:function(){var a=this.props.search_gender_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{onChange:this.onChangeSelectValue},a))}}),g=React.createClass({displayName:"AlbumSearchLong",getDefaultProps:function(){return{search_length_tag:[""]}},getInitialState:function(){return{album_search_long_id:""}},onChangeSelectValue:function(a){var b=da(a.target.value);this.setState({album_search_long_id:b})},render:function(){var a=this.props.search_length_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{onChange:this.onChangeSelectValue},a))}}),h=React.createClass({displayName:"AlbumSearchFeel",getDefaultProps:function(){return{search_feel_tag:[""]}},getInitialState:function(){return{album_search_feel_id:""}},onChangeSelectValue:function(a){var b=da(a.target.value);this.setState({album_search_feel_id:b})},render:function(){var a=this.props.search_feel_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{onChange:this.onChangeSelectValue},a))}}),i=React.createClass({displayName:"AlbumStylistName",getDefaultProps:function(){return{stylist:[""]}},getInitialState:function(){return{t_hairStyle_stylistId:""}},onChangeSelectValue:function(a){this.setState({t_hairStyle_stylistId:a.target.value})},render:function(){var a=this.props.stylist.map(function(a){return React.createElement("option",{value:a.t_stylist_stylist_id},a.t_stylist_name)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_hairStyle_stylistId,onChange:this.onChangeSelectValue},a))}}),m=React.createClass({displayName:"AlbumImagePath",getDefaultProps:function(){return{t_hairStyle_imagePath:""}},getInitialState:function(){return{t_hairStyle_imagePath:"img/notfound.jpg"}},render:function(){return React.createElement("div",null,React.createElement("img",{className:"image",src:this.state.t_hairStyle_imagePath?this.state.t_hairStyle_imagePath:"img/notfound.jpg",width:"0%",height:"0%"}))}}),n=React.createClass({displayName:"AlbumImagePath2",getDefaultProps:function(){return{t_hairStyle_imagePath2:""}},getInitialState:function(){return{t_hairStyle_imagePath2:"img/notfound.jpg"}},render:function(){return React.createElement("div",null,React.createElement("img",{className:"image",src:this.state.t_hairStyle_imagePath2?this.state.t_hairStyle_imagePath2:"img/notfound.jpg",width:"0%",height:"0%"}))}}),o=React.createClass({displayName:"AlbumImagePath3",getDefaultProps:function(){return{t_hairStyle_imagePath3:""}},getInitialState:function(){return{t_hairStyle_imagePath3:"img/notfound.jpg"}},render:function(){return React.createElement("div",null,React.createElement("img",{className:"image",src:this.state.t_hairStyle_imagePath3?this.state.t_hairStyle_imagePath3:"img/notfound.jpg",width:"0%",height:"0%"}))}}),r=React.createClass({displayName:"AlbumList",getInitialState:function(){return{album_list:[{t_hairStyle_id:"",t_hairStyle_hairTypeId:"",t_hairStyle_name:"",t_hairStyle_stylistId:"",t_hairStyle_imagePath:"img/notfound.jpg",t_hairStyle_imagePath2:"img/notfound.jpg",t_hairStyle_imagePath3:"img/notfound.jpg",t_hairStyle_searchConditionId:"",gender:"",hair_length:"",feeling:""}]}},render:function(){var a=1,b=this.state.album_list.map(function(b){return React.createElement("tr",null,React.createElement("td",null,a++),React.createElement("td",null,React.createElement("img",{src:b.t_hairStyle_imagePath?b.t_hairStyle_imagePath:"img/notfound.jpg"})),React.createElement("td",null,React.createElement("img",{src:b.t_hairStyle_imagePath2?b.t_hairStyle_imagePath2:"img/notfound.jpg"})),React.createElement("td",null,React.createElement("img",{src:b.t_hairStyle_imagePath3?b.t_hairStyle_imagePath3:"img/notfound.jpg"})),React.createElement("td",null,React.createElement("a",{className:"edit"},"编辑"),"/",React.createElement("a",{className:"delete"},"删除")))});return React.createElement("div",null,React.createElement("table",null,React.createElement("tbody",null,React.createElement("tr",null,React.createElement("th",null,"No."),React.createElement("th",null,"照片"),React.createElement("th",null,"照片2"),React.createElement("th",null,"照片3"),React.createElement("th",null,"编辑")),b)))}}),s=getHairTypeList();sanitaize.decode(s);for(var t=new Array,u=0;u<s.type.length;u++){var v=s.type[u].t_hairType_id,w=s.type[u].t_hairType_name;t[v]=w}var z=new Array,A={t_masterSearchConditionType:"男性用ヘアスタイル検索条件"},B={t_masterSearchConditionType:"女性用ヘアスタイル検索条件"},C=getSearchConditionList(A),D=getSearchConditionList(B);sanitaize.decode(C),sanitaize.decode(D);var E=C.titles,F=C.values,G=new Array,H=new Array,I=function(a,b){for(u=0;u<a.length;u++)G[u]={id:a[u].id,name:a[u].name},console.log("t_array["+u+"]:{"+G[u].id+":"+G[u].name+"}");for(u=0;u<G.length;u++){H[u]=new Array;var c=0;for(j=0;j<b.length;j++)G[u].id==b[j].titleID&&(H[u][c]={id:b[j].id,name:b[j].name},console.log("v_array["+u+"]["+c+"]:{"+H[u][c].id+":"+H[u][c].name+"}"),c++)}};I(E,F),$("#hs_cond_tag_name1").text(G[0].name+":"),$("#hs_cond_tag_name2").text(G[1].name+":"),$("#hs_cond_tag_name3").text(G[2].name+":");var J=React.render(React.createElement(c,null),document.getElementById("album_name")),K=React.render(React.createElement(i,null),document.getElementById("album_stylist_name")),L=React.render(React.createElement(b,null),document.getElementById("album_sex")),M=React.render(React.createElement(d,null),document.getElementById("album_long")),N=React.render(React.createElement(e,null),document.getElementById("album_feel")),O=React.render(React.createElement(m,null),document.getElementById("album_image_path")),P=React.render(React.createElement(n,null),document.getElementById("album_image_path2")),Q=React.render(React.createElement(o,null),document.getElementById("album_image_path3")),R=React.render(React.createElement(r,null),document.getElementById("album_list_info")),S=React.render(React.createElement(f,null),document.getElementById("album_search_sex")),T=React.render(React.createElement(g,null),document.getElementById("album_search_long")),U=React.render(React.createElement(h,null),document.getElementById("album_search_feel"));$("#album_sex_list").tagit({placeholderText:"",fieldName:"tags"}),$("#album_long_list").tagit({placeholderText:"",fieldName:"tags2"}),$("#album_feel_list").tagit({placeholderText:"",fieldName:"tags3"});var V=getSessionInfo(),W=getAlbumInfo(V.t_hairSalonMaster_salonId);sanitaize.decode(W);var X=getStylistList({t_hairSalonMaster_salonId:V.t_hairSalonMaster_salonId});sanitaize.decode(X);for(var u=0;u<X.stylist.length;u++){var Y=X.stylist[u].t_stylist_stylist_id,Z=X.stylist[u].t_stylist_name;z[Y]=Z}var _=function(a){var b=[];for(b.push(" "),u=0;u<H[a].length;u++)b.push(H[a][u].name);return b},aa=_(0);L.setProps({gender_tag:aa}),S.setProps({search_gender_tag:aa});var ba=function(a,b){console.log("function v2: ["+a+":"+b+" ]");var c=[],d=C.titles,e=D.titles,f=C.values,g=D.values;a+="";var h=a.split(",");for(u=0;u<h.length;u++)f[0].id==h[u]?I(d,f):g[1].id==h[u]&&I(e,g);for(u=0;u<h.length;u++){for(j=0;j<f.length;j++)h[u]==f[j].id&&(console.log("i,j="+u+","+j+" men_values:"+f[j].id+","+f[j].name+","+f[j].titleID),f[j].titleID==G[b].id&&c.push(f[j].name));for(j=0;j<g.length;j++)h[u]==g[j].id&&(console.log("i,j="+u+","+j+" women_values:"+g[j].id+","+g[j].name+","+g[j].titleID),g[j].titleID==G[b].id&&c.push(g[j].name))}return c},ca=function(a,b){a+="";var c=a.split(",");for(u=0;u<c.length;u++)if(c[u]==b)return!0;return!1},da=function(a){var b=-1;for(u=0;u<F.length;u++)a==F[u].name&&(b=F[u].id);return b},ea=function(a){var b="";a+="";var c=a.split(","),d=H[0][0],e=H[0][1];for(l=0;l<c.length;l++){if(c[l]==d.id){b=d;break}if(c[l]==e.id){b=e;break}}return b},fa=function(a){var b=[];a+="";var c=a.split(","),d=H[1];for(l=0;l<c.length;l++)for(j=0;j<d.length;j++)if(c[l]==d[j].id){b.push(d[j]);break}return b},ga=function(a){var b=[];a+="";var c=a.split(","),d=H[2];for(l=0;l<c.length;l++)for(j=0;j<d.length;j++)if(c[l]==d[j].id){b.push(d[j]);break}return b};for($("#account-name").text(V.t_hairSalonMaster_contactUserName),J.setProps({t_hairStyle_name:W.name}),K.setProps({stylist:X.stylist}),u=0;u<W.album.length;u++){var ha=W.album[u],ia=ea(ha.t_hairStyle_searchConditionId);W.album[u].gender=ia.name;var ja=fa(ha.t_hairStyle_searchConditionId);if(ja.length>0){var ka=ja[0].name;for(k=1;k<ja.length;k++)ka+=","+ja[k].name;W.album[u].hair_length=ka}var la=ga(ha.t_hairStyle_searchConditionId);if(la.length>0){var ma=la[0].name;for(k=1;k<la.length;k++)ma+=","+la[k].name;W.album[u].feeling=ma}var na=ha.t_hairStyle_imagePath+"",oa=na.split(",");for(k=0;k<oa.length;k++)0==k?(W.album[u].t_hairStyle_imagePath=oa[k],console.log("album_imagePath["+u+"]["+k+"]:"+W.album[u].t_hairStyle_imagePath)):(W.album[u]["t_hairStyle_imagePath"+k+1]=oa[k],console.log("album_imagePath["+u+"]["+k+"1]:"+W.album[u]["t_hairStyle_imagePath"+k+1]))}for(u=0;u<W.album.length;u++){var ha=W.album[u];console.log("album["+u+"]:"),console.log(" t_hairStyle_id:"+ha.t_hairStyle_id),console.log(" t_hairStyle_hairTypeId:"+ha.t_hairStyle_hairTypeId),console.log(" t_hairStyle_imagePath:"+ha.t_hairStyle_imagePath),console.log(" t_hairStyle_imagePath2:"+ha.t_hairStyle_imagePath2),console.log(" t_hairStyle_imagePath3:"+ha.t_hairStyle_imagePath3),console.log(" t_hairStyle_searchConditionId:"+ha.t_hairStyle_searchConditionId),console.log(" gender:"+ha.gender),console.log(" hair_length:"+ha.hair_length),console.log(" feeling:"+ha.feeling)}0!=W.album.length&&(console.log("album_list_length:"+W.album.length),R.setState({album_list:W.album}));var pa="",qa=-1;0!=K.props.stylist.length&&K.setState({t_hairStyle_stylistId:K.props.stylist[0].t_stylist_stylist_id}),$("#album_regist_button").on("click",function(){var a="",b=document.getElementsByName("tags"),c=document.getElementsByName("tags2"),d=document.getElementsByName("tags3"),e="";for(p=0;p<b.length;p++)-1!=da(b[p].value)&&(0==e.length?e=da(b[p].value):e+=","+da(b[p].value));for(q=0;q<c.length;q++)-1!=da(c[q].value)&&(0==e.length?e=da(c[q].value):e+=","+da(c[q].value));for(q=0;q<d.length;q++)-1!=da(d[q].value)&&(0==e.length?e=da(d[q].value):e+=","+da(d[q].value));a=e;var f="";f=O.state.t_hairStyle_imagePath,f+=","+P.state.t_hairStyle_imagePath2,f+=","+Q.state.t_hairStyle_imagePath3,console.log("combine image_path:"+f);var g={t_hairSalonMaster_salonId:V.t_hairSalonMaster_salonId,t_hairStyle_id:qa,t_hairStyle_hairTypeId:"0",t_hairStyle_name:J.state.t_hairStyle_name,t_hairStyle_stylistId:K.state.t_hairStyle_stylistId,t_hairStyle_imagePath:f,t_hairStyle_searchConditionId:a};sanitaize.encode(g);var h=setAlbumInfo(g);"true"==h.result?(alert("Regist Success"),window.location.reload()):alert("Regist Failed")}),$(".edit").on("click",function(){if(0==W.album.length)return!1;var b=$(".edit").index(this);console.log("edit album["+b+"]");var c=R.state.album_list;qa=c[b].t_hairStyle_id,console.log("edit_id:"+qa),a(c[b])}),$(".delete").on("click",function(){if(0==W.album.length)return!1;var a=$(".delete").index(this),b={t_hairStyle_id:W.album[a].t_hairStyle_id};sanitaize.encode(b);var c=deleteAlbumInfo(b);"true"==c.result?(alert("Delete Success"),window.location.reload()):alert("Delete Failed")}),$("#album_image").change(function(){if($(this).prop("files")[0]){var a=new FormData($("#update")[0]);!function(a){$.ajax({type:"POST",url:API_PATH+"uploadImage",async:!0,processData:!1,data:a,dataType:"text",contentType:!1}).then(function(a){if(a=JSON.parse(a),"true"==a.result){O.state.t_hairStyle_imagePath;O.setState({t_hairStyle_imagePath:a.image_path})}else alert("Upload Failed")})}(a)}}),$("#album_image2").change(function(){if($(this).prop("files")[0]){var a=new FormData($("#update")[0]);!function(a){$.ajax({type:"POST",url:API_PATH+"uploadImage",async:!0,processData:!1,data:a,dataType:"text",contentType:!1}).then(function(a){if(a=JSON.parse(a),"true"==a.result){P.state.t_hairStyle_imagePath;P.setState({t_hairStyle_imagePath2:a.image_path})}else alert("Upload Failed")})}(a)}}),$("#album_image3").change(function(){if($(this).prop("files")[0]){var a=new FormData($("#update")[0]);!function(a){$.ajax({type:"POST",url:API_PATH+"uploadImage",async:!0,processData:!1,data:a,dataType:"text",contentType:!1}).then(function(a){if(a=JSON.parse(a),"true"==a.result){Q.state.t_hairStyle_imagePath;Q.setState({t_hairStyle_imagePath3:a.image_path})}else alert("Upload Failed")})}(a)}}),$("#album_search_button").on("click",function(){var a=S.state.album_search_sex_id,b=T.state.album_search_long_id,c=U.state.album_search_feel_id,d=W.album,e=[];if(""!=a){var f=[];for(x=0;x<d.length;x++){var g=d[x].t_hairStyle_searchConditionId+"",h=g.split(",");for(y=0;y<h.length;y++)a==h[y]&&(f.push(d[x]),console.log("sd1.push: "+x))}}var d=f,i=[];if(""!=b)for(x=0;x<d.length;x++){var g=d[x].t_hairStyle_searchConditionId+"",h=g.split(",");for(y=0;y<h.length;y++)b==h[y]&&(i.push(d[x]),console.log("sd2.push: "+x))}else i=f;var d=i,j=[];if(""!=c)for(x=0;x<d.length;x++){var g=d[x].t_hairStyle_searchConditionId+"",h=g.split(",");for(y=0;y<h.length;y++)c==h[y]&&(j.push(d[x]),console.log("sd3.push: "+x))}else j=i;for(e=j,u=0;u<e.length;u++)console.log("Result:::searched_albums : length:"+e.length+", "+e[u].t_hairStyle_id);e.length>0?R.setState({album_list:e}):console.log("No albums.")})});