$(function(){function a(a){N.setState(a),O.setState({t_hairStyle_stylistId:a.t_hairStyle_stylistId}),W.setState({t_area_name:getAreaNameBySlaveAreaId(da.area,a.t_hairStyle_areaId)});var b=getSlaveAreasByAreaName(da.area,getAreaNameBySlaveAreaId(da.area,a.t_hairStyle_areaId));X.setProps({area:b}),X.setState({t_area_id:a.t_hairStyle_areaId}),Y.setState({t_album_message:a.t_hairStyle_message}),S.setState(a),T.setState(a),U.setState(a),$("#album_sex_list").tagit("removeAll"),$("#album_long_list").tagit("removeAll"),$("#album_feel_list").tagit("removeAll"),Ba=a.t_hairStyle_searchConditionId;var c=na(Ba,0);for(A=0;A<c.length;A++)$("#album_sex_list").tagit("createTag",c[A]);var d=na(Ba,1);for(A=0;A<d.length;A++)$("#album_long_list").tagit("createTag",d[A]);var e=na(Ba,2);for(A=0;A<e.length;A++)$("#album_feel_list").tagit("createTag",e[A])}var b=React.createClass({displayName:"AlbumCountry",getDefaultProps:function(){return{area:[""]}},getInitialState:function(){return{t_area_name:""}},onChangeSelectValue:function(a){var b=getSlaveAreasByAreaName(da.area,a.target.value);X.setProps({area:b}),X.setState({t_area_id:getAreaIdByAreaName(a.target.value,b)}),this.setState({t_area_name:a.target.value})},render:function(){var a=this.props.area.map(function(a){return React.createElement("option",{value:a.area_name},a.area_name)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_area_name,onChange:this.onChangeSelectValue},a))}}),c=React.createClass({displayName:"AlbumArea",getDefaultProps:function(){return{area:[""]}},getInitialState:function(){return{t_area_id:""}},onChangeSelectValue:function(a){this.setState({t_area_id:a.target.value})},render:function(){var a=this.props.area.map(function(a){return React.createElement("option",{value:a.t_area_id},a.t_area_name)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_area_id,onChange:this.onChangeSelectValue},a))}}),d=ReactBootstrap.Input,e=React.createClass({displayName:"AlbumMessage",getDefaultProps:function(){return{t_album_message:[""]}},getInitialState:function(){return{t_album_message:""}},changeText:function(a){this.setState({t_album_message:a.target.value})},render:function(){return React.createElement(d,{type:"text",value:this.state.t_album_message,onChange:this.changeText})}}),f=React.createClass({displayName:"AlbumSex",getDefaultProps:function(){return{gender_tag:[""]}},getInitialState:function(){return{t_hairStyle_searchConditionId:""}},onChangeSelectValue:function(a){L[0][0].name==a.target.value?(I=G.titles,J=G.values,M(I,J)):(I=H.titles,J=H.values,M(I,J));var b=la(1);Q.setProps({length_tag:b});var c=la(2);R.setProps({feel_tag:c});var d=pa(a.target.value);$("#album_sex_list").tagit("removeAll"),$("#album_long_list").tagit("removeAll"),$("#album_feel_list").tagit("removeAll");var e=na(d,0);for(A=0;A<e.length;A++)$("#album_sex_list").tagit("createTag",e[A]);var f=na(Ba,1);for(A=0;A<f.length;A++)$("#album_long_list").tagit("createTag",f[A]);var g=na(Ba,2);for(A=0;A<g.length;A++)$("#album_feel_list").tagit("createTag",g[A]);this.setState({t_hairStyle_searchConditionId:d})},render:function(){var a=this.props.gender_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_hairStyle_searchConditionId,onChange:this.onChangeSelectValue},a))}}),g=React.createClass({displayName:"AlbumName",getInitialState:function(){return{t_hairStyle_name:""}},changeText:function(a){this.setState({t_hairStyle_name:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_hairStyle_name,onChange:this.changeText}))}}),h=React.createClass({displayName:"AlbumLong",getDefaultProps:function(){return{length_tag:[""]}},getInitialState:function(){return{t_hairStyle_searchConditionId:""}},onChangeSelectValue:function(a){var b=pa(a.target.value),c=document.getElementsByName("tags2"),d="";for(p=0;p<c.length;p++)-1!=pa(c[p].value)&&(0==d.length?d=pa(c[p].value):d+=","+pa(c[p].value));Ba=d,Ba+="",oa(Ba,b)||(Ba.length<=0?Ba=b:Ba+=","+b),$("#album_long_list").tagit("removeAll");var e=na(Ba,1);for(A=0;A<e.length;A++)$("#album_long_list").tagit("createTag",e[A]);this.setState({t_hairStyle_searchConditionId:Ba})},render:function(){var a=this.props.length_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_hairStyle_searchConditionId,onChange:this.onChangeSelectValue},a))}}),i=React.createClass({displayName:"AlbumFeel",getDefaultProps:function(){return{feel_tag:[""]}},getInitialState:function(){return{t_hairStyle_searchConditionId:""}},onChangeSelectValue:function(a){var b=pa(a.target.value),c=document.getElementsByName("tags3"),d="";for(p=0;p<c.length;p++)-1!=pa(c[p].value)&&(0==d.length?d=pa(c[p].value):d+=","+pa(c[p].value));Ba=d,Ba+="",oa(Ba,b)||(Ba.length<=0?Ba=b:Ba+=","+b),$("#album_feel_list").tagit("removeAll");var e=na(Ba,2);for(A=0;A<e.length;A++)$("#album_feel_list").tagit("createTag",e[A]);console.log("title2_condId:"+Ba),this.setState({t_hairStyle_searchConditionId:Ba})},render:function(){var a=this.props.feel_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_hairStyle_searchConditionId,onChange:this.onChangeSelectValue},a))}}),m=React.createClass({displayName:"AlbumSearchSex",getDefaultProps:function(){return{search_gender_tag:[""]}},getInitialState:function(){return{album_search_sex_id:""}},onChangeSelectValue:function(a){L[0][0].name==a.target.value?(I=G.titles,J=G.values,M(I,J)):(I=H.titles,J=H.values,M(I,J));var b=la(1);_.setProps({search_length_tag:b});var c=la(2);aa.setProps({search_feel_tag:c});var d=pa(a.target.value);this.setState({album_search_sex_id:d})},render:function(){var a=this.props.search_gender_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{onChange:this.onChangeSelectValue},a))}}),n=React.createClass({displayName:"AlbumSearchLong",getDefaultProps:function(){return{search_length_tag:[""]}},getInitialState:function(){return{album_search_long_id:""}},onChangeSelectValue:function(a){var b=pa(a.target.value);this.setState({album_search_long_id:b})},render:function(){var a=this.props.search_length_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{onChange:this.onChangeSelectValue},a))}}),o=React.createClass({displayName:"AlbumSearchFeel",getDefaultProps:function(){return{search_feel_tag:[""]}},getInitialState:function(){return{album_search_feel_id:""}},onChangeSelectValue:function(a){var b=pa(a.target.value);this.setState({album_search_feel_id:b})},render:function(){var a=this.props.search_feel_tag.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{onChange:this.onChangeSelectValue},a))}}),r=React.createClass({displayName:"AlbumStylistName",getDefaultProps:function(){return{stylist:[""]}},getInitialState:function(){return{t_hairStyle_stylistId:""}},onChangeSelectValue:function(a){this.setState({t_hairStyle_stylistId:a.target.value})},render:function(){var a=this.props.stylist.map(function(a){return React.createElement("option",{value:a.t_stylist_Id},a.t_stylist_name)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_hairStyle_stylistId,onChange:this.onChangeSelectValue},a))}}),s=React.createClass({displayName:"AlbumImagePath",getDefaultProps:function(){return{t_hairStyle_imagePath:""}},getInitialState:function(){return{t_hairStyle_imagePath:"img/notfound.jpg"}},render:function(){return React.createElement("div",null,React.createElement("img",{className:"image",src:this.state.t_hairStyle_imagePath?this.state.t_hairStyle_imagePath:"img/notfound.jpg",width:"0%",height:"0%"}))}}),t=React.createClass({displayName:"AlbumImagePath2",getDefaultProps:function(){return{t_hairStyle_imagePath2:""}},getInitialState:function(){return{t_hairStyle_imagePath2:"img/notfound.jpg"}},render:function(){return React.createElement("div",null,React.createElement("img",{className:"image",src:this.state.t_hairStyle_imagePath2?this.state.t_hairStyle_imagePath2:"img/notfound.jpg",width:"0%",height:"0%"}))}}),u=React.createClass({displayName:"AlbumImagePath3",getDefaultProps:function(){return{t_hairStyle_imagePath3:""}},getInitialState:function(){return{t_hairStyle_imagePath3:"img/notfound.jpg"}},render:function(){return React.createElement("div",null,React.createElement("img",{className:"image",src:this.state.t_hairStyle_imagePath3?this.state.t_hairStyle_imagePath3:"img/notfound.jpg",width:"0%",height:"0%"}))}}),v=React.createClass({displayName:"AlbumList",getInitialState:function(){return{album_list:[{t_hairStyle_id:"",t_hairStyle_hairTypeId:"",t_hairStyle_name:"",t_hairStyle_stylistId:"",t_hairStyle_imagePath:"img/notfound.jpg",t_hairStyle_imagePath2:"img/notfound.jpg",t_hairStyle_imagePath3:"img/notfound.jpg",t_hairStyle_searchConditionId:"",gender:"",hair_length:"",feeling:""}]}},render:function(){var a=1,b=this.state.album_list.map(function(b){return React.createElement("tr",null,React.createElement("td",null,a++),React.createElement("td",null,React.createElement("img",{src:b.t_hairStyle_imagePath?b.t_hairStyle_imagePath:"img/notfound.jpg"})),React.createElement("td",null,React.createElement("img",{src:b.t_hairStyle_imagePath2?b.t_hairStyle_imagePath2:"img/notfound.jpg"})),React.createElement("td",null,React.createElement("img",{src:b.t_hairStyle_imagePath3?b.t_hairStyle_imagePath3:"img/notfound.jpg"})),React.createElement("td",null,React.createElement("a",{className:"edit"},"编辑"),"/",React.createElement("a",{className:"delete"},"删除")))});return React.createElement("div",null,React.createElement("table",null,React.createElement("tbody",null,React.createElement("tr",null,React.createElement("th",null,"No."),React.createElement("th",null,"照片"),React.createElement("th",null,"照片2"),React.createElement("th",null,"照片3"),React.createElement("th",null,"编辑")),b)))}}),w=getHairTypeList();sanitaize.decode(w);for(var z=new Array,A=0;A<w.type.length;A++){var B=w.type[A].t_hairType_id,C=w.type[A].t_hairType_name;z[B]=C}var D=new Array,E={t_masterSearchConditionType:"男性用ヘアスタイル検索条件"},F={t_masterSearchConditionType:"女性用ヘアスタイル検索条件"},G=getSearchConditionList(E),H=getSearchConditionList(F);sanitaize.decode(G),sanitaize.decode(H);var I=G.titles,J=G.values,K=new Array,L=new Array,M=function(a,b){for(A=0;A<a.length;A++)K[A]={id:a[A].id,name:a[A].name};for(A=0;A<K.length;A++){L[A]=new Array;var c=0;for(j=0;j<b.length;j++)K[A].id==b[j].titleID&&(L[A][c]={id:b[j].id,name:b[j].name},c++)}};M(I,J),$("#hs_cond_tag_name1").text(K[0].name+":"),$("#hs_cond_tag_name2").text(K[1].name+":"),$("#hs_cond_tag_name3").text(K[2].name+":");var N=React.render(React.createElement(g,null),document.getElementById("album_name")),O=React.render(React.createElement(r,null),document.getElementById("album_stylist_name")),P=React.render(React.createElement(f,null),document.getElementById("album_sex")),Q=React.render(React.createElement(h,null),document.getElementById("album_long")),R=React.render(React.createElement(i,null),document.getElementById("album_feel")),S=React.render(React.createElement(s,null),document.getElementById("album_image_path")),T=React.render(React.createElement(t,null),document.getElementById("album_image_path2")),U=React.render(React.createElement(u,null),document.getElementById("album_image_path3")),V=React.render(React.createElement(v,null),document.getElementById("album_list_info")),W=React.render(React.createElement(b,null),document.getElementById("album_country")),X=React.render(React.createElement(c,null),document.getElementById("album_area")),Y=React.render(React.createElement(e,null),document.getElementById("album_message")),Z=React.render(React.createElement(m,null),document.getElementById("album_search_sex")),_=React.render(React.createElement(n,null),document.getElementById("album_search_long")),aa=React.render(React.createElement(o,null),document.getElementById("album_search_feel"));$("#album_sex_list").tagit({placeholderText:"",fieldName:"tags"}),$("#album_long_list").tagit({placeholderText:"",fieldName:"tags2"}),$("#album_feel_list").tagit({placeholderText:"",fieldName:"tags3"});var ba=getSessionInfo(),ca=getAlbumInfo(ba.t_hairSalonMaster_salonId);sanitaize.decode(ca);var da=getCountryAreaList();sanitaize.decode(da);for(var ea=new Array,A=(new Array,0);A<da.area.length;A++){var fa=da.area[A].t_area_id,ga=da.area[A].t_area_name;ea[A]={area_id:fa,area_name:ga}}var ga=getAreaNameBySlaveAreaId(da.area,ca.album[0].t_hairStyle_areaId),ha=getSlaveAreasByAreaName(da.area,ga),ia=getStylistList({t_hairSalonMaster_salonId:ba.t_hairSalonMaster_salonId});sanitaize.decode(ia);for(var A=0;A<ia.stylist.length;A++){var ja=ia.stylist[A].t_stylist_Id,ka=ia.stylist[A].t_stylist_name;D[ja]=ka}var la=function(a){var b=[];for(b.push(" "),A=0;A<L[a].length;A++)b.push(L[a][A].name);return b},ma=la(0);P.setProps({gender_tag:ma}),Z.setProps({search_gender_tag:ma});var na=function(a,b){var c=[],d=G.titles,e=H.titles,f=G.values,g=H.values;a+="";var h=a.split(",");for(A=0;A<h.length;A++)f[0].id==h[A]?M(d,f):g[1].id==h[A]&&M(e,g);for(A=0;A<h.length;A++){for(j=0;j<f.length;j++)h[A]==f[j].id&&f[j].titleID==K[b].id&&c.push(f[j].name);for(j=0;j<g.length;j++)h[A]==g[j].id&&g[j].titleID==K[b].id&&c.push(g[j].name)}return c},oa=function(a,b){a+="";var c=a.split(",");for(A=0;A<c.length;A++)if(c[A]==b)return!0;return!1},pa=function(a){var b=-1;for(A=0;A<J.length;A++)a==J[A].name&&(b=J[A].id);return b},qa=function(a){var b="";a+="";var c=a.split(","),d=L[0][0],e=L[0][1];for(l=0;l<c.length;l++){if(c[l]==d.id){b=d;break}if(c[l]==e.id){b=e;break}}return b},ra=function(a){var b=[];a+="";var c=a.split(","),d=L[1];for(l=0;l<c.length;l++)for(j=0;j<d.length;j++)if(c[l]==d[j].id){b.push(d[j]);break}return b},sa=function(a){var b=[];a+="";var c=a.split(","),d=L[2];for(l=0;l<c.length;l++)for(j=0;j<d.length;j++)if(c[l]==d[j].id){b.push(d[j]);break}return b};for($("#account-name").text(ba.t_hairSalonMaster_contactUserName),N.setProps({t_hairStyle_name:ca.name}),O.setProps({stylist:ia.stylist}),W.setState({t_area_name:ga}),W.setProps({area:ea}),X.setProps({area:ha}),X.setState({t_area_id:ca.album[0].t_hairStyle_areaId}),A=0;A<ca.album.length;A++){var ta=ca.album[A],ua=qa(ta.t_hairStyle_searchConditionId);ca.album[A].gender=ua.name;var va=ra(ta.t_hairStyle_searchConditionId);if(va.length>0){var wa=va[0].name;for(k=1;k<va.length;k++)wa+=","+va[k].name;ca.album[A].hair_length=wa}var xa=sa(ta.t_hairStyle_searchConditionId);if(xa.length>0){var ya=xa[0].name;for(k=1;k<xa.length;k++)ya+=","+xa[k].name;ca.album[A].feeling=ya}var za=ta.t_hairStyle_imagePath+"",Aa=za.split(",");for(k=0;k<Aa.length;k++)0==k?ca.album[A].t_hairStyle_imagePath=Aa[k]:ca.album[A]["t_hairStyle_imagePath"+k+1]=Aa[k]}for(A=0;A<ca.album.length;A++){var ta=ca.album[A];console.log("album["+A+"]:"),console.log(" t_hairStyle_id:"+ta.t_hairStyle_id),console.log(" t_hairStyle_hairTypeId:"+ta.t_hairStyle_hairTypeId),console.log(" t_hairStyle_imagePath:"+ta.t_hairStyle_imagePath),console.log(" t_hairStyle_imagePath2:"+ta.t_hairStyle_imagePath2),console.log(" t_hairStyle_imagePath3:"+ta.t_hairStyle_imagePath3),console.log(" t_hairStyle_searchConditionId:"+ta.t_hairStyle_searchConditionId)}0!=ca.album.length&&(console.log("album_list_length:"+ca.album.length),V.setState({album_list:ca.album}));var Ba="",Ca=-1;0!=O.props.stylist.length&&O.setState({t_hairStyle_stylistId:O.props.stylist[0].t_stylist_Id}),$("#album_regist_button").on("click",function(){function a(a){var b;return b=10>a?"0"+a:a}var b="",c=document.getElementsByName("tags"),d=document.getElementsByName("tags2"),e=document.getElementsByName("tags3"),f="";for(p=0;p<c.length;p++)-1!=pa(c[p].value)&&(0==f.length?f=pa(c[p].value):f+=","+pa(c[p].value));for(q=0;q<d.length;q++)-1!=pa(d[q].value)&&(0==f.length?f=pa(d[q].value):f+=","+pa(d[q].value));for(q=0;q<e.length;q++)-1!=pa(e[q].value)&&(0==f.length?f=pa(e[q].value):f+=","+pa(e[q].value));b=f;var g="";g=S.state.t_hairStyle_imagePath,g+=","+T.state.t_hairStyle_imagePath2,g+=","+U.state.t_hairStyle_imagePath3;var h=new Date,i=h.getFullYear()+"-";i+=h.getMonth()+1+"-",i+=h.getDate()+"";var j=a(h.getHours()),k=a(h.getMinutes()),l=a(h.getSeconds()),m=i+" "+j+":"+k+":"+l,n={t_hairSalonMaster_salonId:ba.t_hairSalonMaster_salonId,t_hairStyle_id:Ca,t_hairStyle_hairTypeId:"0",t_hairStyle_name:N.state.t_hairStyle_name,t_hairStyle_stylistId:O.state.t_hairStyle_stylistId,t_hairStyle_imagePath:g,t_hairStyle_searchConditionId:b,t_hairStyle_areaId:X.state.t_area_id,t_hairStyle_updateDate:m,t_hairStyle_message:Y.state.t_album_message};sanitaize.encode(n);var o=setAlbumInfo(n);"true"==o.result?(alert("Regist Success"),window.location.reload()):alert("Regist Failed")}),$(".edit").on("click",function(){if(0==ca.album.length)return!1;var b=$(".edit").index(this),c=V.state.album_list;Ca=c[b].t_hairStyle_id,a(c[b])}),$(".delete").on("click",function(){if(0==ca.album.length)return!1;var a=!1;if(function(){window.confirm("本当に削除しますか？")?(console.log("OK clicked."),a=!0):(alert("キャンセルされました"),a=!1)}(),!a)return!1;var b=$(".delete").index(this),c={t_hairStyle_id:ca.album[b].t_hairStyle_id};sanitaize.encode(c);var d=deleteAlbumInfo(c);"true"==d.result?(alert("Delete Success"),window.location.reload()):alert("Delete Failed")}),$("#album_image").change(function(){if($(this).prop("files")[0]){var a=new FormData($("#update")[0]);!function(a){$.ajax({type:"POST",url:API_PATH+"uploadImage",async:!0,processData:!1,data:a,dataType:"text",contentType:!1}).then(function(a){if(a=JSON.parse(a),"true"==a.result){S.state.t_hairStyle_imagePath;S.setState({t_hairStyle_imagePath:a.image_path})}else alert("Upload Failed")})}(a)}}),$("#album_image2").change(function(){if($(this).prop("files")[0]){var a=new FormData($("#update")[0]);!function(a){$.ajax({type:"POST",url:API_PATH+"uploadImage",async:!0,processData:!1,data:a,dataType:"text",contentType:!1}).then(function(a){if(a=JSON.parse(a),"true"==a.result){T.state.t_hairStyle_imagePath;T.setState({t_hairStyle_imagePath2:a.image_path})}else alert("Upload Failed")})}(a)}}),$("#album_image3").change(function(){if($(this).prop("files")[0]){var a=new FormData($("#update")[0]);!function(a){$.ajax({type:"POST",url:API_PATH+"uploadImage",async:!0,processData:!1,data:a,dataType:"text",contentType:!1}).then(function(a){if(a=JSON.parse(a),"true"==a.result){U.state.t_hairStyle_imagePath;U.setState({t_hairStyle_imagePath3:a.image_path})}else alert("Upload Failed")})}(a)}}),$("#album_search_button").on("click",function(){var a=Z.state.album_search_sex_id,b=_.state.album_search_long_id,c=aa.state.album_search_feel_id,d=ca.album,e=[];if(""!=a){var f=[];for(x=0;x<d.length;x++){var g=d[x].t_hairStyle_searchConditionId+"",h=g.split(",");for(y=0;y<h.length;y++)a==h[y]&&f.push(d[x])}}var d=f,i=[];if(""!=b)for(x=0;x<d.length;x++){var g=d[x].t_hairStyle_searchConditionId+"",h=g.split(",");for(y=0;y<h.length;y++)b==h[y]&&i.push(d[x])}else i=f;var d=i,j=[];if(""!=c)for(x=0;x<d.length;x++){var g=d[x].t_hairStyle_searchConditionId+"",h=g.split(",");for(y=0;y<h.length;y++)c==h[y]&&j.push(d[x])}else j=i;for(e=j,A=0;A<e.length;A++);e.length>0?V.setState({album_list:e}):(alert("検索結果がありませんでした。"),console.log("No albums."))})});