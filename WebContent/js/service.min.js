$(function(){function a(a){n.setState(a),o.setState(a),p.setState(a),q.setState(a),r.setState(a),s.setState(a)}var b=React.createClass({displayName:"ServiceCategory",getDefaultProps:function(){return{category:[""]}},getInitialState:function(){return{t_menu_categoryId:""}},onChangeSelectValue:function(a){this.setState({t_menu_categoryId:a.target.value})},render:function(){var a=this.props.category.map(function(a){return React.createElement("option",{value:a.t_menuCategory_categoryId},a.t_menuCategory_name)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_menu_categoryId,onChange:this.onChangeSelectValue},a))}}),c=React.createClass({displayName:"ServiceName",getInitialState:function(){return{t_menu_name:""}},changeText:function(a){this.setState({t_menu_name:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_menu_name,onChange:this.changeText}))}}),d=React.createClass({displayName:"ServiceDetailText",getInitialState:function(){return{t_menu_detailText:""}},onChangeText:function(a){this.setState({t_menu_detailText:a.target.value})},onClick:function(){this.setState({t_menu_detailText:this.refs.textArea.getDOMNode().value})},render:function(){return React.createElement("div",null,React.createElement("div",null,React.createElement("textarea",{value:this.state.t_menu_detailText,onChange:this.onChangeText})))}}),e=React.createClass({displayName:"ServicePrice",getInitialState:function(){return{t_menu_price:""}},changeText:function(a){this.setState({t_menu_price:a.target.value})},render:function(){return React.createElement("div",null,React.createElement("input",{type:"text",value:this.state.t_menu_price,onChange:this.changeText}))}}),f=React.createClass({displayName:"ServiceTime",getDefaultProps:function(){return{menu_time:["10","20","30","40","50","60","70","80","90","100","110","120","130","140","150","160","170","180"]}},getInitialState:function(){return{t_menu_time:this.props.menu_time[0]}},onChangeSelectValue:function(a){this.setState({t_menu_time:a.target.value})},render:function(){var a=this.props.menu_time.map(function(a){return React.createElement("option",{value:a},a)});return React.createElement("div",null,React.createElement("select",{value:this.state.t_menu_time,onChange:this.onChangeSelectValue},a))}}),g=React.createClass({displayName:"ServiceImagePath",getInitialState:function(){return{t_menu_imagePath:"img/notfound.jpg"}},render:function(){return React.createElement("div",null,React.createElement("img",{className:"service_image_img",src:this.state.t_menu_imagePath?this.state.t_menu_imagePath:"img/notfound.jpg"}))}}),h=React.createClass({displayName:"ServiceList",getInitialState:function(){return{service_list:[{t_menu_categoryId:"",t_menu_menuId:"",t_menu_name:"",t_menu_price:"",t_menu_detailText:"",t_menu_imagePath:"img/notfound.jpg"}]}},render:function(){var a=1,b=this.state.service_list.map(function(b){return React.createElement("tr",null,React.createElement("td",null,a++),React.createElement("td",null,j[b.t_menu_categoryId]),React.createElement("td",null,b.t_menu_name),React.createElement("td",null,b.t_menu_time),React.createElement("td",null,React.createElement("img",{src:b.t_menu_imagePath?b.t_menu_imagePath:"img/notfound.jpg"})),React.createElement("td",null,React.createElement("a",{className:"edit"},"编辑"),"/",React.createElement("a",{className:"delete"},"删除")))});return React.createElement("div",null,React.createElement("table",null,React.createElement("tr",null,React.createElement("th",null,"No."),React.createElement("th",null,"分类"),React.createElement("th",null,"服务名称"),React.createElement("th",null,"時間"),React.createElement("th",null,"照片"),React.createElement("th",null,"编辑")),b))}}),i=getServiceCategoryList();sanitaize.decode(i);for(var j=new Array,k=0;k<i.category.length;k++){var l=i.category[k].t_menuCategory_categoryId,m=i.category[k].t_menuCategory_name;j[l]=m}var n=React.render(React.createElement(b,null),document.getElementById("service_category")),o=React.render(React.createElement(c,null),document.getElementById("service_name")),p=React.render(React.createElement(d,null),document.getElementById("service_detail_text")),q=React.render(React.createElement(e,null),document.getElementById("service_price")),r=React.render(React.createElement(f,null),document.getElementById("service_time")),s=React.render(React.createElement(g,null),document.getElementById("service_image_path")),t=React.render(React.createElement(h,null),document.getElementById("service_list_info")),u=getSessionInfo(),v=getMenuInfo(u.t_hairSalonMaster_salonId);sanitaize.decode(v),$("#account-name").text(u.t_hairSalonMaster_contactUserName),n.setProps({category:i.category}),n.setState({t_menu_categoryId:n.props.category[0].t_menuCategory_categoryId}),0!=v.menu.length&&t.setState({service_list:v.menu}),$("#service_regist_button").on("click",function(){var a={t_hairSalonMaster_salonId:u.t_hairSalonMaster_salonId,t_menu_menuId:n.state.t_menu_menuId,t_menu_categoryId:n.state.t_menu_categoryId,t_menu_name:o.state.t_menu_name,t_menu_price:q.state.t_menu_price,t_menu_detailText:p.state.t_menu_detailText,t_menu_imagePath:s.state.t_menu_imagePath,t_menu_time:r.state.t_menu_time};sanitaize.encode(a);var b=setMenuInfo(a);"true"==b.result?(alert("Regist Success"),window.location.reload()):alert("Regist Failed")}),$(".edit").on("click",function(){if(0==v.menu.length)return!1;var b=$(".edit").index(this);a(v.menu[b])}),$(".delete").on("click",function(){if(0==v.menu.length)return!1;var a=$(".delete").index(this),b={t_menu_menuId:v.menu[a].t_menu_menuId};sanitaize.encode(b);var c=deleteMenuInfo(b);"true"==c.result?(alert("Delete Success"),window.location.reload()):alert("Delete Failed")}),$("#service_image").change(function(){if($(this).prop("files")[0]){var a=new FormData($("#update")[0]);console.log("async upload image."),function(a){$.ajax({type:"POST",url:API_PATH+"uploadImage",async:!0,processData:!1,data:a,dataType:"text",contentType:!1}).then(function(a){a=JSON.parse(a),"true"==a.result?s.setState({t_menu_imagePath:a.image_path}):alert("Upload Failed")})}(a)}})});